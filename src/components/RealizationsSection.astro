---
import systemZarzadzaniaEnergia from '../assets/system-zarzadzania-energia.webp';
import inteligetneOswietlenieLed from '../assets/inteligetne-oswietlenie-led.webp';
import systemAutomatykiBudowlanej from '../assets/system-automatyki-budowlanej.jpg';
import Realization from './Realization.astro';
import type { Realization as RealizationType } from '../models/Realization';

// TODO: import from realizations
const projects: RealizationType[] = [
	{
		title: 'Instalacja Elektryczna i Teletechniczna',
		client: 'Uniwersytet Ekonomiczny we Wrocławiu',
		image: systemZarzadzaniaEnergia,
		category: 'Edukacja',
		description: 'Wykonanie instalacji elektrycznej oraz sieci teletechnicznej w pomieszczeniach dziekanatów i korytarza w budynku A.',
		date: '19 stycznia 2021',
		testimonial: 'Profesjonalna realizacja i wysoka jakość wykonanych prac. Znacząca poprawa infrastruktury technicznej.',
		author: 'Dr Adam Nowicki',
		position: 'Kierownik Administracyjny',
	},
	{
		title: 'Utrzymanie Łączności Alarmowej',
		client: 'Egis Projects Polska SA',
		image: inteligetneOswietlenieLed,
		category: 'Infrastruktura',
		description: 'Utrzymanie w sprawności łączności alarmowej na autostradzie A4 Wrocław-Katowice.',
		date: '19 stycznia 2021',
		testimonial: 'Niezawodne wsparcie techniczne i szybka reakcja na zgłoszenia. Kluczowy partner w utrzymaniu bezpieczeństwa na autostradzie.',
		author: 'Marek Wiśniewski',
		position: 'Kierownik ds. Utrzymania',
	},
	{
		title: 'Farma Fotowoltaiczna i Automatyka Budynkowa',
		client: 'Uniwersytet Opolski',
		image: systemAutomatykiBudowlanej,
		category: 'Edukacja',
		description:
			'Wykonanie farmy fotowoltaicznej, systemu automatyki budynkowej (sterowanie grzejnikami) oraz opomiarowania i odczytów energii elektrycznej.',
		date: '19 stycznia 2021',
		testimonial: 'Innowacyjne rozwiązania znacząco obniżyły koszty energii i zwiększyły efektywność energetyczną całego kampusu.',
		author: 'Prof. Tomasz Kowalski',
		position: 'Prorektor ds. Rozwoju i Finansów',
	},
	{
		title: 'Wyposażenie Serwerowni',
		client: 'SPZOZ w Głuchołazach',
		image: systemZarzadzaniaEnergia,
		category: 'Zdrowie',
		description: 'Wyposażenie serwerowni, system SSWIN, CCTV oraz kontroli dostępu.',
		testimonial: 'Profesjonalna implementacja systemów bezpieczeństwa znacząco podniosła poziom ochrony naszych danych i infrastruktury.',
		author: 'Dr Maria Kowalczyk',
		position: 'Dyrektor ds. IT',
		date: '07-09.2018',
	},
	{
		title: 'Dostosowanie Budynku do Wymogów Przeciwpożarowych',
		client: 'Starostwo Powiatowe w Krapkowicach',
		image: inteligetneOswietlenieLed,
		category: 'Administracja',
		description: 'Dostosowanie budynku starostwa do wymogów przeciwpożarowych.',
		date: '19 stycznia 2021',
		testimonial: 'Kompleksowa modernizacja znacząco poprawiła bezpieczeństwo naszego budynku. Prace zostały wykonane profesjonalnie i terminowo.',
		author: 'Paweł Kowalczyk',
		position: 'Dyrektor Administracyjny',
	},
	{
		title: 'Wymiana Oświetlenia na LED',
		client: 'Szpital Wojewódzki w Opolu sp. z o.o.',
		image: systemAutomatykiBudowlanej,
		category: 'Zdrowie',
		description: 'Dostawa i wymiana oświetlenia na energooszczędne w technologii LED.',
		date: '19 stycznia 2021',
		testimonial: 'Modernizacja oświetlenia znacząco obniżyła koszty energii oraz poprawiła komfort pracy personelu i pacjentów.',
		author: 'Dr Andrzej Nowak',
		position: 'Dyrektor ds. Infrastruktury',
	},
];
---

<section class="py-20 bg-gray-50">
	<div class="container mx-auto px-6">
		<!-- Section Header -->
		<div class="text-center mb-16" data-aos="fade-up">
			<h2 class="text-4xl font-bold text-primary mb-4">Nasze Realizacje</h2>
			<p class="text-xl text-gray-600">Zobacz, co udało nam się osiągnąć dla naszych klientów</p>
		</div>

		<!-- Projects Grid -->
		<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-6">
			{projects.slice(0, 3).map((project, index) => <Realization project={project} index={index} />)}
		</div>

		<div class="m-auto text-center">
			<a
				href="/realizacje"
				class="px-8 py-3 bg-white text-primary border-2 border-primary rounded-full font-medium hover:bg-accent hover:border-accent hover:text-white transition-all duration-300 hover:scale-105 text-center"
			>
				Zobacz wszystkie
			</a>
		</div>

		<!-- Testimonials Slider -->
		<div class="w-full overflow-hidden mt-8" data-aos="fade-up">
			<div class="relative px-4">
				<!-- Testimonials Container -->
				<div class="keen-slider" id="testimonials-slider">
					{
						projects.map((project) => (
							<div class="keen-slider__slide px-4">
								<div class="bg-white rounded-xl shadow-lg p-8 text-center max-w-2xl mx-auto">
									<div class="text-accent text-4xl mb-6">"</div>
									<blockquote class="text-gray-600 text-lg italic mb-6">{project.testimonial}</blockquote>
									<div class="font-medium">
										<cite class="text-gray-900 not-italic">{project.author}</cite>
										<p class="text-accent mt-1">{project.position}</p>
									</div>
								</div>
							</div>
						))
					}
				</div>
			</div>
		</div>

		<script>
			import KeenSlider from 'keen-slider';

			document.addEventListener('DOMContentLoaded', () => {
				const sliderElement = document.getElementById('testimonials-slider');
				if (!sliderElement) return;
				const screenWidth = window.innerWidth;
				const baseDuration = 20000;
				const durationMultiplier = Math.max(1, screenWidth / 1000);
				const animation = {
					duration: baseDuration * durationMultiplier,
					easing: (t: number) => t,
				};
				const slider = new KeenSlider(sliderElement, {
					loop: true,
					slides: {
						origin: 'center',
						perView: 1,
					},
					breakpoints: {
						'(min-width: 800px)': {
							slides: {
								perView: 3,
							},
						},
					},
					created(s) {
						s.moveToIdx(5, true, animation);
					},
					updated(s) {
						s.moveToIdx(s.track.details.abs + 5, true, animation);
					},
					animationEnded(s) {
						s.moveToIdx(s.track.details.abs + 5, true, animation);
					},
				});

				return () => {
					if (slider) slider.destroy();
				};
			});
		</script>

		<style>
			@import 'keen-slider/keen-slider.min.css';
			.keen-slider {
				width: 100%;
				min-height: 200px;
			}

			.keen-slider__slide {
				width: 100%;
				min-width: 0;
				padding-bottom: 20px;
			}
		</style>
	</div>
</section>
